<!doctype html><html lang=ja><head><meta charset=utf-8><title>【React+TypeScript】TypeScript入門 - yyh-gl's Tech Blog</title><meta name=viewport content="width=device-width,initial-scale=1"><link rel=apple-touch-icon sizes=180x180 href="/tech-blog/favicon/apple-touch-icon.png?v=1"><link rel=icon type=image/png sizes=32x32 href="/tech-blog/favicon/favicon-32x32.png?v=1"><link rel=icon type=image/png sizes=16x16 href="/tech-blog/favicon/favicon-16x16.png?v=1"><link rel=manifest href="/tech-blog/favicon/site.webmanifest?v=1"><link rel=mask-icon href="/tech-blog/favicon/safari-pinned-tab.svg?v=1" color=#ffffff><link rel="shortcut icon" href="/tech-blog/favicon/favicon.ico?v=1"><meta name=msapplication-config content="/tech-blog/favicon/browserconfig.xml?v=1"><meta name=msapplication-TileColor content="#ffffff"><meta name=theme-color content="#ffffff"><meta name=generator content="Hugo 0.77.0"><meta property="og:site_name" content="yyh-gl's Tech Blog"><meta property="og:title" content="【React+TypeScript】TypeScript入門"><meta property="og:description" content="TypeScript Advent Calendar 2019 2日目"><meta property="description" content="TypeScript Advent Calendar 2019 2日目"><meta property="og:url" content="https://yyh-gl.github.io/tech-blog/blog/react_typescript_sample/"><meta property="og:type" content="article"><meta property="og:image" content="https://yyh-gl.github.io/tech-blog/img/main/logo.png"><link rel=stylesheet href=/tech-blog/css/bundle.min.e4a0b0705b8f8ce6273c21134a9e69bb89bd526da868b7e33bfa5fb249ba0c2b.css integrity="sha256-5KCwcFuPjOYnPCETSp5pu4m9Um2oaLfjO/pfskm6DCs="><link rel=stylesheet href=/tech-blog/css/add-on.css><script src=https://cdn.jsdelivr.net/npm/axios/dist/axios.min.js></script><script src=/tech-blog/js/vue.min.js></script><script src=/tech-blog/js/good-counter.js defer></script></head><body><header id=site-header><nav id=site-nav><h1 class=nav-title><a href=/tech-blog/ class=nav>Blog</a></h1><menu id=site-nav-menu class="flyout-menu menu"><a href=/tech-blog/ class="nav link"><i class="fa fa-home"></i>Home</a>
<a href=/tech-blog/about/ class="nav link"><i class="far fa-id-card"></i>About</a>
<a href=/tech-blog/blog/ class="nav link"><i class="far fa-newspaper"></i>Blog</a>
<a href=/tech-blog/categories/ class="nav link"><i class="fas fa-sitemap"></i>Categories</a></menu>
<a href=#site-nav class="nav nav-toggle"><i class="fas fa-bars fa-2x"></i></a></nav></header><div id=wrapper><section id=site-intro><a href=/tech-blog/><img src=https://yyh-gl.github.io/tech-blog/img/main/logo.png class=circle width=80 alt="yyh-gl's icon"></a><header><h1>yyh-gl's Tech Blog</h1></header><main><p>技術ネタ中心のブログです。主な扱いはバックエンド技術と設計です。</p></main><footer><ul class=socnet-icons><li><a href=//github.com/yyh-gl target=_blank rel=noopener title=GitHub class="fab fa-github"></a></li><li><a href=//twitter.com/yyh_gl target=_blank rel=noopener title=Twitter class="fab fa-twitter"></a></li></ul></footer></section><main id=site-main><article class=post><header><div class=title><h2><a href=/tech-blog/blog/react_typescript_sample/>【React+TypeScript】TypeScript入門</a></h2><p>TypeScript Advent Calendar 2019 2日目</p></div><div class=meta><time datetime="2019-12-02 00:00:00 +0000 UTC">2019-12-02</time><p>yyh-gl</p><p>6 分で読めます</p></div></header><div id=socnet-share></div><div class=content><a href=/tech-blog/blog/react_typescript_sample/ class=image style="--bg-image: url('https://yyh-gl.github.io/tech-blog/img/tech-blog/2019/12/react_typescript_sample/featured.png')"><img src=https://yyh-gl.github.io/tech-blog/img/tech-blog/2019/12/react_typescript_sample/featured.png alt=画像がどこかへ逝ってしまったようだ…></a><hr><h1 id=typescript-advent-calendar-2019>TypeScript Advent Calendar 2019</h1><hr><img src=https://yyh-gl.github.io/tech-blog/img/tech-blog/2019/12/react_typescript_sample/qiita_advent_calendar_2019.png width=700><p>本記事は <a href=https://qiita.com/advent-calendar/2019/typescript>TypeScript Advent Calendar 2019</a> の 2 日目の記事です。</p><p>内容としては、TypeScript 初級者のための TypeScript 入門です。</p><p>基礎的な内容から入り、<br>最終的には、企業や個人の技術ブログを参考に、<br>React の実プロジェクトにおいて、<br>どのように TypeScript が使われているのか紹介できればと思います。<br>（APIリクエスト周りのTypeScript活用事例を紹介）</p><p>今日の記事を読んで TypeScript に入門し、<br>今後の TypeScript Advent Calendar をお楽しみいただけると幸いです！</p><br><hr><h1 id=基礎編>基礎編</h1><hr><h2 id=typescript-とは>TypeScript とは</h2><img src=https://yyh-gl.github.io/tech-blog/img/tech-blog/2019/12/react_typescript_sample/ts.png width=200><p><a href=https://www.typescriptlang.org/index.html>TypeScript</a> は Microsoft 社によって開発され、
現在は <a href=https://github.com/microsoft/TypeScript>OSS</a> として開発が進められています。</p><p>「TypeScript とは何か」を簡単に説明すると、<br><u>JavaScript に対して、省略も可能な静的型付けとクラスベースオブジェクト指向を加えたスーパーセット</u> です。</p><p><a href=https://www.typescriptlang.org/>公式サイト</a> はこちらで、<br>2019年12月2日現在、最新版は 3.7.2 となっています。</p><p>では、実際にコードを交えながら基礎的な部分を説明していきます。<br>ただし、実践編で使用する内容に絞って説明していきますので、<br>その点はご了承ください🙇‍<br>（足りない情報は<a href=https://www.typescriptlang.org/docs/home.html>公式ドキュメント</a>を参考にしてください）</p><br><h2 id=型>型</h2><p>では、早速、TypeScript の型に触れていきましょう。<br>TypeScript で使用できる基本的な型として以下のものがあります。</p><ul><li>Boolean</li><li>Number</li><li>String</li><li>Array</li><li>Tuple</li><li>Enum</li><li>Any</li><li>Void</li><li>Null and Undefined</li><li>Never</li><li>Object</li></ul><p>だいたいの型は他言語でも用意されているので、<br>説明がなくても理解できると思います。</p><p>Tuple や Never といった、他言語では見慣れない型もあると思いますが、<br>他サイトでたくさん説明されているので割愛します。</p><p>【参考サイト】</p><ul><li><a href=https://www.typescriptlang.org/docs/handbook/basic-types.html>公式サイト</a></li><li><a href=https://qiita.com/uhyo/items/e2fdef2d3236b9bfe74a>Qiita記事</a></li></ul><p>型の宣言方法は以下のとおりです。</p><div class=highlight><pre style=color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-typescript data-lang=typescript><span style="margin-right:.4em;padding:0 .4em;color:#7f7f7f">1</span><span style=color:#66d9ef>function</span> <span style=color:#a6e22e>greeter</span>(<span style=color:#a6e22e>person</span>: <span style=color:#66d9ef>string</span>) {
<span style="margin-right:.4em;padding:0 .4em;color:#7f7f7f">2</span>    <span style=color:#66d9ef>return</span> <span style=color:#e6db74>&#34;Hello, &#34;</span> <span style=color:#f92672>+</span> <span style=color:#a6e22e>person</span>;
<span style="margin-right:.4em;padding:0 .4em;color:#7f7f7f">3</span>}
<span style="margin-right:.4em;padding:0 .4em;color:#7f7f7f">4</span>
<span style="margin-right:.4em;padding:0 .4em;color:#7f7f7f">5</span><span style=color:#66d9ef>const</span> <span style=color:#a6e22e>user</span>: <span style=color:#66d9ef>string</span> <span style=color:#f92672>=</span> <span style=color:#e6db74>&#34;Jane User&#34;</span>;
<span style="margin-right:.4em;padding:0 .4em;color:#7f7f7f">6</span>
<span style="margin-right:.4em;padding:0 .4em;color:#7f7f7f">7</span>document.<span style=color:#a6e22e>body</span>.<span style=color:#a6e22e>textContent</span> <span style=color:#f92672>=</span> <span style=color:#a6e22e>greeter</span>(<span style=color:#a6e22e>user</span>);
</code></pre></div><p>1行目にて、greeter() に person という string 型の引数を渡すことが明示されています。<br>また、変数 <code>user</code> は string 型であることが明記されています。</p><p>仮に <code>greeter()</code> に string 型以外の値を渡すと、<br>コンパイル時 or IDE 上にエラーが吐かれるので、ミスに気づくことが可能です。</p><br><h2 id=インターフェース>インターフェース</h2><p>次にインターフェースについて見ていきます。</p><p>インターフェースは本来、JavaScript に無い機能ですが、<br>TypeScript によってその機能が追加されています。</p><p>インターフェースは、クラスやオブジェクトの規格を定義するのに使用します。<br>クラスだけでなく、オブジェクトの規格を定義できるため、<br>API のレスポンスとして返ってくるデータ（＝オブジェクト）の規格を定義することが可能です。</p><p>有用性の高い機能のひとつではないでしょうか。</p><p>定義方法は以下のとおりです。</p><div class=highlight><pre style=color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-typescript data-lang=typescript><span style="margin-right:.4em;padding:0 .4em;color:#7f7f7f"> 1</span><span style=color:#66d9ef>interface</span> <span style=color:#a6e22e>LabeledValue</span> {
<span style="margin-right:.4em;padding:0 .4em;color:#7f7f7f"> 2</span>    <span style=color:#a6e22e>label</span>: <span style=color:#66d9ef>string</span>;
<span style="margin-right:.4em;padding:0 .4em;color:#7f7f7f"> 3</span>}
<span style="margin-right:.4em;padding:0 .4em;color:#7f7f7f"> 4</span>
<span style="margin-right:.4em;padding:0 .4em;color:#7f7f7f"> 5</span><span style=color:#66d9ef>function</span> <span style=color:#a6e22e>printLabel</span>(<span style=color:#a6e22e>labeledObj</span>: <span style=color:#66d9ef>LabeledValue</span>) {
<span style="margin-right:.4em;padding:0 .4em;color:#7f7f7f"> 6</span>    <span style=color:#a6e22e>console</span>.<span style=color:#a6e22e>log</span>(<span style=color:#a6e22e>labeledObj</span>.<span style=color:#a6e22e>label</span>);
<span style="margin-right:.4em;padding:0 .4em;color:#7f7f7f"> 7</span>}
<span style="margin-right:.4em;padding:0 .4em;color:#7f7f7f"> 8</span>
<span style="margin-right:.4em;padding:0 .4em;color:#7f7f7f"> 9</span><span style=color:#66d9ef>let</span> <span style=color:#a6e22e>myObj</span> <span style=color:#f92672>=</span> {<span style=color:#a6e22e>size</span>: <span style=color:#66d9ef>10</span>, <span style=color:#a6e22e>label</span><span style=color:#f92672>:</span> <span style=color:#e6db74>&#34;Size 10 Object&#34;</span>};
<span style="margin-right:.4em;padding:0 .4em;color:#7f7f7f">10</span><span style=color:#a6e22e>printLabel</span>(<span style=color:#a6e22e>myObj</span>);
</code></pre></div><p>上記コードは、<code>LabeledValue</code> というインターフェースと、<br>そのインターフェースを満たす <code>myObj</code> というオブジェクトを定義しています。<br>加えて、<code>printLabel()</code> という <code>LabeledValue</code> インターフェースを受け取る関数が用意されています。</p><p><code>myObj</code> は <code>label</code> を持っているので、<code>LabeledValue</code> インターフェースを満たしており、<br><code>printLabel()</code> に引数として渡すことが可能です。</p><p>クラスの規格定義としてのインターフェースは以下のとおりです。<br>こちらは他言語でよく見る形なので詳細な説明は省略します。</p><div class=highlight><pre style=color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-typescript data-lang=typescript><span style="margin-right:.4em;padding:0 .4em;color:#7f7f7f"> 1</span><span style=color:#66d9ef>interface</span> <span style=color:#a6e22e>ClockInterface</span> {
<span style="margin-right:.4em;padding:0 .4em;color:#7f7f7f"> 2</span>    <span style=color:#a6e22e>currentTime</span>: <span style=color:#66d9ef>Date</span>;
<span style="margin-right:.4em;padding:0 .4em;color:#7f7f7f"> 3</span>    <span style=color:#a6e22e>setTime</span>(<span style=color:#a6e22e>d</span>: <span style=color:#66d9ef>Date</span>)<span style=color:#f92672>:</span> <span style=color:#66d9ef>void</span>;
<span style="margin-right:.4em;padding:0 .4em;color:#7f7f7f"> 4</span>}
<span style="margin-right:.4em;padding:0 .4em;color:#7f7f7f"> 5</span>
<span style="margin-right:.4em;padding:0 .4em;color:#7f7f7f"> 6</span><span style=color:#66d9ef>class</span> <span style=color:#a6e22e>Clock</span> <span style=color:#66d9ef>implements</span> <span style=color:#a6e22e>ClockInterface</span> {
<span style="margin-right:.4em;padding:0 .4em;color:#7f7f7f"> 7</span>    <span style=color:#a6e22e>currentTime</span>: <span style=color:#66d9ef>Date</span> <span style=color:#f92672>=</span> <span style=color:#66d9ef>new</span> Date();
<span style="margin-right:.4em;padding:0 .4em;color:#7f7f7f"> 8</span>    <span style=color:#a6e22e>setTime</span>(<span style=color:#a6e22e>d</span>: <span style=color:#66d9ef>Date</span>) {
<span style="margin-right:.4em;padding:0 .4em;color:#7f7f7f"> 9</span>        <span style=color:#66d9ef>this</span>.<span style=color:#a6e22e>currentTime</span> <span style=color:#f92672>=</span> <span style=color:#a6e22e>d</span>;
<span style="margin-right:.4em;padding:0 .4em;color:#7f7f7f">10</span>    }
<span style="margin-right:.4em;padding:0 .4em;color:#7f7f7f">11</span>    <span style=color:#66d9ef>constructor</span>(<span style=color:#a6e22e>h</span>: <span style=color:#66d9ef>number</span>, <span style=color:#a6e22e>m</span>: <span style=color:#66d9ef>number</span>) { }
<span style="margin-right:.4em;padding:0 .4em;color:#7f7f7f">12</span>}
</code></pre></div><p>なお、クラスという概念は JavaScript（ES6） に組み込まれているクラスの機能を<br>ES6 以前の JavaScript でも使えるようにしたものです。</p><br><h2 id=入門時の落とし穴>入門時の落とし穴</h2><p>僕が TypeScript を初めて触ったときに戸惑ったのが以下のエラーでした。</p><div class=highlight><pre style=color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-zsh data-lang=zsh><span style="margin-right:.4em;padding:0 .4em;color:#7f7f7f">1</span>Could not find a declaration file <span style=color:#66d9ef>for</span> module <span style=color:#e6db74>&#39;react-router-config&#39;</span>. <span style=color:#e6db74>&#39;/hoge/index.js&#39;</span> implicitly has an <span style=color:#e6db74>&#39;any&#39;</span> type.
<span style="margin-right:.4em;padding:0 .4em;color:#7f7f7f">2</span>  Try <span style=color:#e6db74>`</span>npm install @types/react-router-config<span style=color:#e6db74>`</span> <span style=color:#66d9ef>if</span> it exists or add a new declaration <span style=color:#f92672>(</span>.d.ts<span style=color:#f92672>)</span> file containing <span style=color:#e6db74>`</span>declare module <span style=color:#e6db74>&#39;react-router-config&#39;</span>;<span style=color:#e6db74>`</span>  TS7016
<span style="margin-right:.4em;padding:0 .4em;color:#7f7f7f">3</span>
<span style="margin-right:.4em;padding:0 .4em;color:#7f7f7f">4</span>    <span style=color:#ae81ff>1</span> | import React from <span style=color:#e6db74>&#39;react&#39;</span>;
<span style="margin-right:.4em;padding:0 .4em;color:#7f7f7f">5</span>  &gt; <span style=color:#ae81ff>2</span> | import <span style=color:#f92672>{</span> renderRoutes, RouteConfigComponentProps <span style=color:#f92672>}</span> from <span style=color:#e6db74>&#39;react-router-config&#39;</span>;
<span style="margin-right:.4em;padding:0 .4em;color:#7f7f7f">6</span>      |                                                         ^
<span style="margin-right:.4em;padding:0 .4em;color:#7f7f7f">7</span>    <span style=color:#ae81ff>3</span> | import <span style=color:#e6db74>&#39;./App.css&#39;</span>;
<span style="margin-right:.4em;padding:0 .4em;color:#7f7f7f">8</span>    <span style=color:#ae81ff>4</span> | 
<span style="margin-right:.4em;padding:0 .4em;color:#7f7f7f">9</span>    <span style=color:#ae81ff>5</span> | const App: React.FC&lt;RouteConfigComponentProps&gt; <span style=color:#f92672>=</span> <span style=color:#f92672>({</span> route <span style=color:#f92672>})</span> <span style=color:#f92672>=</span>&gt; <span style=color:#f92672>{</span>
</code></pre></div><p>このエラーが何を言っているかと言うと、<br>「ライブラリで使用する関数や変数に関する型宣言情報がないから、どう解釈したらいいか分からん！」<br>ってことです。</p><p>ライブラリは TypeScript のためではなく、JavaScript のためのものなので、<br>インポートしたライブラリの中には、TypeScript 対応していないものがあるのは当然ですよね。</p><p>では、どうするかですが、<br><code>@types</code> を使ってやればOKです。</p><br><h2 id=types>@types</h2><p><code>@types</code> を使用することで、提供されている型定義ファイルを取得することができます。</p><p><a href=https://typescript-jp.gitbook.io/deep-dive/type-system/types>本サイト</a>によると、<br>JavaScriptライブラリの90%に対応しているんだとか。<br>すごすぎる。。。</p><p>例えば、さきほどのエラーに対応する場合は、<br><code>npm install @types/react-router-config</code> を実行してやることで、<br>react-router-config ライブラリの型に関する定義を取得できます。</p><br><h2 id=型定義ファイル>型定義ファイル</h2><p>もし型定義ファイルが提供されていない場合は、
自分で型定義ファイルを作る必要があります。
作るときは<a href=https://qiita.com/Nossa/items/726cc3e67527e896ed1e#2-%E5%9E%8B%E5%AE%9A%E7%BE%A9%E3%83%95%E3%82%A1%E3%82%A4%E3%83%AB-dts-%E3%82%92%E8%87%AA%E4%BD%9C%E3%81%99%E3%82%8B>本サイト</a>
が参考になると思います。</p><p>（<a href=https://qiita.com/Nossa/items/726cc3e67527e896ed1e#3-require-%E3%81%A7%E3%83%A2%E3%82%B8%E3%83%A5%E3%83%BC%E3%83%AB%E3%82%92%E8%AA%AD%E3%81%BF%E8%BE%BC%E3%82%80>こんな技</a>
もあるようですが…）</p><br><hr><h1 id=実践編>実践編</h1><hr><p>では、（かなりざっくりと）基本的なことはお話したので、<br>実践的な内容に入っていきます。</p><p>今回は、React + TypeScript を使用します。</p><p>ソースは<a href=https://github.com/yyh-gl/react-typescript-sample>GitHub</a>上にあげています。</p><br><h2 id=react--typescript-環境のセットアップ>React ＋ TypeScript 環境のセットアップ</h2><p>React ＋ TypeScript の開発環境は下記コマンドひとつで揃います。<br><code>$ npx create-react-app my-app --typescript</code></p><p>ここから、src配下のディレクトリ構成を少し変更していきます。<br>今回は下記のようなディレクトリ構成を取りました。<br>Webのフロントエンド開発においてよく見られる形ではないでしょうか？</p><div class=highlight><pre style=color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-zsh data-lang=zsh><span style="margin-right:.4em;padding:0 .4em;color:#7f7f7f"> 1</span>$ tree react-typescript-sample
<span style="margin-right:.4em;padding:0 .4em;color:#7f7f7f"> 2</span>react-typescript-sample
<span style="margin-right:.4em;padding:0 .4em;color:#7f7f7f"> 3</span>├── package-lock.json
<span style="margin-right:.4em;padding:0 .4em;color:#7f7f7f"> 4</span>├── package.json
<span style="margin-right:.4em;padding:0 .4em;color:#7f7f7f"> 5</span>├── public
<span style="margin-right:.4em;padding:0 .4em;color:#7f7f7f"> 6</span>├── src
<span style="margin-right:.4em;padding:0 .4em;color:#7f7f7f"> 7</span>│   ├── App.css
<span style="margin-right:.4em;padding:0 .4em;color:#7f7f7f"> 8</span>│   ├── App.test.tsx
<span style="margin-right:.4em;padding:0 .4em;color:#7f7f7f"> 9</span>│   ├── App.tsx
<span style="margin-right:.4em;padding:0 .4em;color:#7f7f7f">10</span>│   ├── api
<span style="margin-right:.4em;padding:0 .4em;color:#7f7f7f">11</span>│   │   ├── client.ts
<span style="margin-right:.4em;padding:0 .4em;color:#7f7f7f">12</span>│   │   └── user.ts
<span style="margin-right:.4em;padding:0 .4em;color:#7f7f7f">13</span>│   ├── components
<span style="margin-right:.4em;padding:0 .4em;color:#7f7f7f">14</span>│   ├── index.css
<span style="margin-right:.4em;padding:0 .4em;color:#7f7f7f">15</span>│   ├── index.tsx
<span style="margin-right:.4em;padding:0 .4em;color:#7f7f7f">16</span>│   ├── layouts
<span style="margin-right:.4em;padding:0 .4em;color:#7f7f7f">17</span>│   ├── models
<span style="margin-right:.4em;padding:0 .4em;color:#7f7f7f">18</span>│   │   └── user.ts
<span style="margin-right:.4em;padding:0 .4em;color:#7f7f7f">19</span>│   ├── pages
<span style="margin-right:.4em;padding:0 .4em;color:#7f7f7f">20</span>│   │   └── users.tsx
<span style="margin-right:.4em;padding:0 .4em;color:#7f7f7f">21</span>│   ├── react-app-env.d.ts
<span style="margin-right:.4em;padding:0 .4em;color:#7f7f7f">22</span>│   ├── router
<span style="margin-right:.4em;padding:0 .4em;color:#7f7f7f">23</span>│   │   └── index.tsx
<span style="margin-right:.4em;padding:0 .4em;color:#7f7f7f">24</span>│   └── serviceWorker.ts
<span style="margin-right:.4em;padding:0 .4em;color:#7f7f7f">25</span>├── tsconfig.json
<span style="margin-right:.4em;padding:0 .4em;color:#7f7f7f">26</span>└── yarn.lock
</code></pre></div><p>なお、今回は説明しやすくするために、<br><code>components</code> および <code>layouts</code> は使用していません。</p><p>本来であれば、<code>pages</code> は <code>components</code> 配下のコンポーネントを組み合わせることにより表現します。<br><code>components</code> 配下は、Atomic Design に沿ったディレクトリ構成が取られることが多い気がします。</p><p>また、ページのレイアウト（ヘッダーやフッター、メインコンテンツの位置など）は、<br><code>layouts</code> 配下のコンポーネントによって表現します。</p><br><h2 id=api-リクエスト>API リクエスト</h2><p>最近のフロントエンドでは、<br>フロントから API リクエストを行うシーンが多くあると思います。</p><p>そのさいに、API のレスポンスが<br>どういったフィールドを持っているのかが定義されていれば、<br>以下のようなメリットがあります。</p><ul><li>レスポンス内容がフロントのコードから読み取れる<ul><li>存在しないパラメータにアクセスしようとするといった凡ミスを無くせる</li></ul></li><li>IDE による補完が効く</li></ul><p>では、実際にどうやって API のレスポンスを定義するのか見ていきます。</p><p>今回は、例としてユーザ情報を受け取る API を用意しました。
下記のような JSON を取得します。</p><div class=highlight><pre style=color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-json data-lang=json><span style="margin-right:.4em;padding:0 .4em;color:#7f7f7f"> 1</span><span style=color:#960050;background-color:#1e0010>GET</span> <span style=color:#960050;background-color:#1e0010>https://localhost:</span><span style=color:#ae81ff>3000</span><span style=color:#960050;background-color:#1e0010>/api/v</span><span style=color:#ae81ff>1</span><span style=color:#960050;background-color:#1e0010>/users</span>
<span style="margin-right:.4em;padding:0 .4em;color:#7f7f7f"> 2</span>
<span style="margin-right:.4em;padding:0 .4em;color:#7f7f7f"> 3</span>[
<span style="margin-right:.4em;padding:0 .4em;color:#7f7f7f"> 4</span>    {
<span style="margin-right:.4em;padding:0 .4em;color:#7f7f7f"> 5</span>        <span style=color:#f92672>&#34;id&#34;</span>: <span style=color:#ae81ff>1</span>,
<span style="margin-right:.4em;padding:0 .4em;color:#7f7f7f"> 6</span>        <span style=color:#f92672>&#34;first_name&#34;</span>: <span style=color:#e6db74>&#34;信長&#34;</span>,
<span style="margin-right:.4em;padding:0 .4em;color:#7f7f7f"> 7</span>        <span style=color:#f92672>&#34;last_name&#34;</span>: <span style=color:#e6db74>&#34;織田&#34;</span>
<span style="margin-right:.4em;padding:0 .4em;color:#7f7f7f"> 8</span>    },
<span style="margin-right:.4em;padding:0 .4em;color:#7f7f7f"> 9</span>    {
<span style="margin-right:.4em;padding:0 .4em;color:#7f7f7f">10</span>        <span style=color:#f92672>&#34;id&#34;</span>: <span style=color:#ae81ff>2</span>,
<span style="margin-right:.4em;padding:0 .4em;color:#7f7f7f">11</span>        <span style=color:#f92672>&#34;first_name&#34;</span>: <span style=color:#e6db74>&#34;秀吉&#34;</span>,
<span style="margin-right:.4em;padding:0 .4em;color:#7f7f7f">12</span>        <span style=color:#f92672>&#34;last_name&#34;</span>: <span style=color:#e6db74>&#34;豊臣&#34;</span>
<span style="margin-right:.4em;padding:0 .4em;color:#7f7f7f">13</span>    },
<span style="margin-right:.4em;padding:0 .4em;color:#7f7f7f">14</span>    {
<span style="margin-right:.4em;padding:0 .4em;color:#7f7f7f">15</span>        <span style=color:#f92672>&#34;id&#34;</span>: <span style=color:#ae81ff>3</span>,
<span style="margin-right:.4em;padding:0 .4em;color:#7f7f7f">16</span>        <span style=color:#f92672>&#34;first_name&#34;</span>: <span style=color:#e6db74>&#34;光秀&#34;</span>,
<span style="margin-right:.4em;padding:0 .4em;color:#7f7f7f">17</span>        <span style=color:#f92672>&#34;last_name&#34;</span>: <span style=color:#e6db74>&#34;明智&#34;</span>
<span style="margin-right:.4em;padding:0 .4em;color:#7f7f7f">18</span>    }
<span style="margin-right:.4em;padding:0 .4em;color:#7f7f7f">19</span>]
</code></pre></div><br><h2 id=1-interface-を定義>1. interface を定義</h2><p>まずは、ユーザ情報がどういった形式で送られてくるのか、<br>interfaceを使って表現します。</p><div class=highlight><pre style=color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-typescript data-lang=typescript><span style="margin-right:.4em;padding:0 .4em;color:#7f7f7f">1</span><span style=color:#75715e>// /src/models/user.ts
</span><span style="margin-right:.4em;padding:0 .4em;color:#7f7f7f">2</span><span style=color:#75715e></span>
<span style="margin-right:.4em;padding:0 .4em;color:#7f7f7f">3</span><span style=color:#66d9ef>export</span> <span style=color:#66d9ef>interface</span> <span style=color:#a6e22e>User</span> {
<span style="margin-right:.4em;padding:0 .4em;color:#7f7f7f">4</span>    <span style=color:#a6e22e>id</span>: <span style=color:#66d9ef>number</span>;
<span style="margin-right:.4em;padding:0 .4em;color:#7f7f7f">5</span>    <span style=color:#a6e22e>firstName</span>: <span style=color:#66d9ef>string</span>;
<span style="margin-right:.4em;padding:0 .4em;color:#7f7f7f">6</span>    <span style=color:#a6e22e>lastName</span>: <span style=color:#66d9ef>string</span>;
<span style="margin-right:.4em;padding:0 .4em;color:#7f7f7f">7</span>}
</code></pre></div><br><h2 id=2-api-クライアントを実装>2. API クライアントを実装</h2><p>次は API リクエストを送る Axios クライアントを作っていきます。</p><div class=highlight><pre style=color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-typescript data-lang=typescript><span style="margin-right:.4em;padding:0 .4em;color:#7f7f7f"> 1</span><span style=color:#75715e>// /src/api/client.js
</span><span style="margin-right:.4em;padding:0 .4em;color:#7f7f7f"> 2</span><span style=color:#75715e></span>
<span style="margin-right:.4em;padding:0 .4em;color:#7f7f7f"> 3</span><span style=color:#66d9ef>import</span> <span style=color:#a6e22e>axios</span>, { <span style=color:#a6e22e>AxiosInstance</span>, <span style=color:#a6e22e>AxiosResponse</span> } <span style=color:#66d9ef>from</span> <span style=color:#e6db74>&#39;axios&#39;</span>;
<span style="margin-right:.4em;padding:0 .4em;color:#7f7f7f"> 4</span><span style=color:#66d9ef>import</span> <span style=color:#a6e22e>camelCaseKeys</span> <span style=color:#66d9ef>from</span> <span style=color:#e6db74>&#39;camelcase-keys&#39;</span>;
<span style="margin-right:.4em;padding:0 .4em;color:#7f7f7f"> 5</span>
<span style="margin-right:.4em;padding:0 .4em;color:#7f7f7f"> 6</span><span style=color:#66d9ef>let</span> <span style=color:#a6e22e>client</span>: <span style=color:#66d9ef>AxiosInstance</span>;
<span style="margin-right:.4em;padding:0 .4em;color:#7f7f7f"> 7</span>
<span style="margin-right:.4em;padding:0 .4em;color:#7f7f7f"> 8</span><span style=color:#66d9ef>export</span> <span style=color:#66d9ef>default</span> <span style=color:#a6e22e>client</span> <span style=color:#f92672>=</span> <span style=color:#a6e22e>axios</span>.<span style=color:#a6e22e>create</span>({
<span style="margin-right:.4em;padding:0 .4em;color:#7f7f7f"> 9</span>    <span style=color:#a6e22e>baseURL</span><span style=color:#f92672>:</span> <span style=color:#e6db74>`http://localhost:3000/api/v1`</span>,
<span style="margin-right:.4em;padding:0 .4em;color:#7f7f7f">10</span>    <span style=color:#a6e22e>headers</span><span style=color:#f92672>:</span> {
<span style="margin-right:.4em;padding:0 .4em;color:#7f7f7f">11</span>        <span style=color:#e6db74>&#39;Content-Type&#39;</span><span style=color:#f92672>:</span> <span style=color:#e6db74>&#39;application/json&#39;</span>,
<span style="margin-right:.4em;padding:0 .4em;color:#7f7f7f">12</span>    }
<span style="margin-right:.4em;padding:0 .4em;color:#7f7f7f">13</span>});
<span style="margin-right:.4em;padding:0 .4em;color:#7f7f7f">14</span>
<span style="margin-right:.4em;padding:0 .4em;color:#7f7f7f">15</span><span style=color:#a6e22e>client</span>.<span style=color:#a6e22e>interceptors</span>.<span style=color:#a6e22e>response</span>.<span style=color:#a6e22e>use</span>(
<span style="margin-right:.4em;padding:0 .4em;color:#7f7f7f">16</span>    (<span style=color:#a6e22e>response</span>: <span style=color:#66d9ef>AxiosResponse</span>)<span style=color:#f92672>:</span> <span style=color:#a6e22e>AxiosResponse</span> <span style=color:#f92672>=&gt;</span> {
<span style="margin-right:.4em;padding:0 .4em;color:#7f7f7f">17</span>        <span style=color:#66d9ef>const</span> <span style=color:#a6e22e>data</span> <span style=color:#f92672>=</span> <span style=color:#a6e22e>camelCaseKeys</span>(<span style=color:#a6e22e>response</span>.<span style=color:#a6e22e>data</span>);
<span style="margin-right:.4em;padding:0 .4em;color:#7f7f7f">18</span>        <span style=color:#66d9ef>return</span> { ...<span style=color:#a6e22e>response</span>.<span style=color:#a6e22e>data</span>, <span style=color:#a6e22e>data</span> };
<span style="margin-right:.4em;padding:0 .4em;color:#7f7f7f">19</span>    }
<span style="margin-right:.4em;padding:0 .4em;color:#7f7f7f">20</span>);
</code></pre></div><p>ここで注目すべき点が2つあります。</p><p>1つ目は、Axios をインポートするさいに型情報も合わせて取得している点です。<br>3行目にて、<code>axios</code> 以外に <code>AxiosInstance</code> と <code>AxiosResponse</code> を取得しています。</p><p>この <code>AxiosInstance</code> と <code>AxiosResponse</code> こそが Axios ライブラリで使用する型情報です。<br>それぞれ 6行目 と 16行目 で使用しています。</p><p>2つ目は、<code>camelcase-keys</code> というライブラリを使用している点です。<br>JavaScript のコーディング規約では、変数名にキャメルケースを使用します。<br>しかしながら、 JSON のキー名は多くの場合でスネークケースです。</p><p>つまり、普通に JSON を受け取ると、<br><code>resposen.first_name</code> のようにしてデータを取り出します。</p><p>しかし、これでは JavaScript の命名規則的に気持ち悪いですね。<br>加えて、<code>User</code> モデル（interface）は <code>firstName</code> として定義しているため、<br><code>first_name</code> として受け取るのはよろしくありません。</p><p>ここで <code>camelcase-keys</code> ライブラリの登場です。<br>スネークケースのキー名をキャメルケースに変換するためのもので、<br>本ライブラリを用いて、受け取った JSON データのキー名を全てをキャメルケースに変換しています。</p><p>TypeScript の話から少し脱線しましたが、<br>これで User インターフェースどおりのオブジェクトを受け取ることが可能になりました。</p><br><h2 id=3-ユーザ一覧取得-api-リクエストを実装>3. ユーザ一覧取得 API リクエストを実装</h2><p>では、さきほど実装した Axios クライアントを使って、<br>API サーバにユーザ情報をもらうリクエストをします。</p><div class=highlight><pre style=color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-typescript data-lang=typescript><span style="margin-right:.4em;padding:0 .4em;color:#7f7f7f">1</span><span style=color:#75715e>// /src/api/user.ts
</span><span style="margin-right:.4em;padding:0 .4em;color:#7f7f7f">2</span><span style=color:#75715e></span>
<span style="margin-right:.4em;padding:0 .4em;color:#7f7f7f">3</span><span style=color:#66d9ef>import</span> { <span style=color:#a6e22e>AxiosPromise</span> } <span style=color:#66d9ef>from</span> <span style=color:#e6db74>&#39;axios&#39;</span>;
<span style="margin-right:.4em;padding:0 .4em;color:#7f7f7f">4</span>
<span style="margin-right:.4em;padding:0 .4em;color:#7f7f7f">5</span><span style=color:#66d9ef>import</span> <span style=color:#a6e22e>client</span> <span style=color:#66d9ef>from</span> <span style=color:#e6db74>&#39;./client&#39;</span>;
<span style="margin-right:.4em;padding:0 .4em;color:#7f7f7f">6</span><span style=color:#66d9ef>import</span> { <span style=color:#a6e22e>User</span> } <span style=color:#66d9ef>from</span> <span style=color:#e6db74>&#39;../models/user&#39;</span>;
<span style="margin-right:.4em;padding:0 .4em;color:#7f7f7f">7</span>
<span style="margin-right:.4em;padding:0 .4em;color:#7f7f7f">8</span><span style=color:#66d9ef>export</span> <span style=color:#66d9ef>const</span> <span style=color:#a6e22e>fetchUsers</span> <span style=color:#f92672>=</span> ()<span style=color:#f92672>:</span> <span style=color:#a6e22e>AxiosPromise</span>&lt;<span style=color:#f92672>User</span><span style=color:#960050;background-color:#1e0010>[]</span>&gt; <span style=color:#f92672>=&gt;</span> <span style=color:#a6e22e>client</span>.<span style=color:#66d9ef>get</span>(<span style=color:#e6db74>`/users`</span>);
</code></pre></div><p>8行目にて、<code>User[]</code> を受け取ることを明示しています。</p><br><h2 id=4-ユーザ一覧を取得表示>4. ユーザ一覧を取得＆表示</h2><p>では、受け取ったユーザ情報を表示してみます。<br>なお、冒頭で説明したとおり、<br>簡略化のために、表示に関する全実装を <code>pages</code> コンポーネント内で行います。</p><div class=highlight><pre style=color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-typescript data-lang=typescript><span style="margin-right:.4em;padding:0 .4em;color:#7f7f7f"> 1</span><span style=color:#75715e>// /src/pages/users.tsx
</span><span style="margin-right:.4em;padding:0 .4em;color:#7f7f7f"> 2</span><span style=color:#75715e></span>
<span style="margin-right:.4em;padding:0 .4em;color:#7f7f7f"> 3</span><span style=color:#66d9ef>import</span> <span style=color:#a6e22e>React</span>, { <span style=color:#a6e22e>useEffect</span>, <span style=color:#a6e22e>useState</span> } <span style=color:#66d9ef>from</span> <span style=color:#e6db74>&#39;react&#39;</span>;
<span style="margin-right:.4em;padding:0 .4em;color:#7f7f7f"> 4</span>
<span style="margin-right:.4em;padding:0 .4em;color:#7f7f7f"> 5</span><span style=color:#66d9ef>import</span> { <span style=color:#a6e22e>fetchUsers</span> } <span style=color:#66d9ef>from</span> <span style=color:#e6db74>&#39;../api/user&#39;</span>;
<span style="margin-right:.4em;padding:0 .4em;color:#7f7f7f"> 6</span><span style=color:#66d9ef>import</span> { <span style=color:#a6e22e>User</span> } <span style=color:#66d9ef>from</span> <span style=color:#e6db74>&#39;../models/user&#39;</span>;
<span style="margin-right:.4em;padding:0 .4em;color:#7f7f7f"> 7</span>
<span style="margin-right:.4em;padding:0 .4em;color:#7f7f7f"> 8</span><span style=color:#66d9ef>const</span> <span style=color:#a6e22e>Users</span>: <span style=color:#66d9ef>React.FC</span> <span style=color:#f92672>=</span> () <span style=color:#f92672>=&gt;</span> {
<span style="margin-right:.4em;padding:0 .4em;color:#7f7f7f"> 9</span>    <span style=color:#66d9ef>const</span> [<span style=color:#a6e22e>userList</span>, <span style=color:#a6e22e>setUserList</span>] <span style=color:#f92672>=</span> <span style=color:#a6e22e>useState</span>&lt;<span style=color:#f92672>User</span><span style=color:#960050;background-color:#1e0010>[]</span> <span style=color:#960050;background-color:#1e0010>|</span> <span style=color:#a6e22e>undefined</span>&gt;(<span style=color:#66d9ef>undefined</span>);
<span style="margin-right:.4em;padding:0 .4em;color:#7f7f7f">10</span>
<span style="margin-right:.4em;padding:0 .4em;color:#7f7f7f">11</span>    <span style=color:#66d9ef>const</span> <span style=color:#a6e22e>fetchUsersReq</span> <span style=color:#f92672>=</span> <span style=color:#66d9ef>async</span> () <span style=color:#f92672>=&gt;</span> {
<span style="margin-right:.4em;padding:0 .4em;color:#7f7f7f">12</span>        <span style=color:#66d9ef>try</span> {
<span style="margin-right:.4em;padding:0 .4em;color:#7f7f7f">13</span>            <span style=color:#66d9ef>const</span> { <span style=color:#a6e22e>data</span> } <span style=color:#f92672>=</span> <span style=color:#66d9ef>await</span> <span style=color:#a6e22e>fetchUsers</span>();
<span style="margin-right:.4em;padding:0 .4em;color:#7f7f7f">14</span>            <span style=color:#66d9ef>return</span> <span style=color:#a6e22e>data</span>;
<span style="margin-right:.4em;padding:0 .4em;color:#7f7f7f">15</span>        } <span style=color:#66d9ef>catch</span> (<span style=color:#a6e22e>e</span>) {
<span style="margin-right:.4em;padding:0 .4em;color:#7f7f7f">16</span>            <span style=color:#a6e22e>console</span>.<span style=color:#a6e22e>log</span>(<span style=color:#a6e22e>e</span>);
<span style="margin-right:.4em;padding:0 .4em;color:#7f7f7f">17</span>        }
<span style="margin-right:.4em;padding:0 .4em;color:#7f7f7f">18</span>    };
<span style="margin-right:.4em;padding:0 .4em;color:#7f7f7f">19</span>
<span style="margin-right:.4em;padding:0 .4em;color:#7f7f7f">20</span>    <span style=color:#a6e22e>useEffect</span>(() <span style=color:#f92672>=&gt;</span> {
<span style="margin-right:.4em;padding:0 .4em;color:#7f7f7f">21</span>        <span style=color:#66d9ef>const</span> <span style=color:#a6e22e>data</span> <span style=color:#f92672>=</span> <span style=color:#a6e22e>fetchUsersReq</span>();
<span style="margin-right:.4em;padding:0 .4em;color:#7f7f7f">22</span>        <span style=color:#a6e22e>data</span>.<span style=color:#a6e22e>then</span>(<span style=color:#a6e22e>users</span> <span style=color:#f92672>=&gt;</span> {
<span style="margin-right:.4em;padding:0 .4em;color:#7f7f7f">23</span>            <span style=color:#a6e22e>setUserList</span>(<span style=color:#a6e22e>users</span>);
<span style="margin-right:.4em;padding:0 .4em;color:#7f7f7f">24</span>        });
<span style="margin-right:.4em;padding:0 .4em;color:#7f7f7f">25</span>    }, []);
<span style="margin-right:.4em;padding:0 .4em;color:#7f7f7f">26</span>
<span style="margin-right:.4em;padding:0 .4em;color:#7f7f7f">27</span>    <span style=color:#66d9ef>return</span> (
<span style="margin-right:.4em;padding:0 .4em;color:#7f7f7f">28</span>        &lt;&gt;
<span style="margin-right:.4em;padding:0 .4em;color:#7f7f7f">29</span>            &lt;<span style=color:#f92672>h1</span>&gt;<span style=color:#a6e22e>User</span> <span style=color:#a6e22e>List</span>&lt;/<span style=color:#f92672>h1</span>&gt;
<span style="margin-right:.4em;padding:0 .4em;color:#7f7f7f">30</span>            {
<span style="margin-right:.4em;padding:0 .4em;color:#7f7f7f">31</span>                <span style=color:#a6e22e>userList</span> <span style=color:#f92672>&amp;&amp;</span> <span style=color:#a6e22e>userList</span>.<span style=color:#a6e22e>map</span>((<span style=color:#a6e22e>user</span>) <span style=color:#f92672>=&gt;</span> {
<span style="margin-right:.4em;padding:0 .4em;color:#7f7f7f">32</span>                    <span style=color:#66d9ef>return</span> (
<span style="margin-right:.4em;padding:0 .4em;color:#7f7f7f">33</span>                        &lt;<span style=color:#f92672>p</span> <span style=color:#a6e22e>key</span><span style=color:#f92672>=</span>{<span style=color:#a6e22e>user</span>.<span style=color:#a6e22e>id</span>}&gt;{<span style=color:#e6db74>`</span><span style=color:#e6db74>${</span><span style=color:#a6e22e>user</span>.<span style=color:#a6e22e>lastName</span><span style=color:#e6db74>}</span><span style=color:#e6db74> </span><span style=color:#e6db74>${</span><span style=color:#a6e22e>user</span>.<span style=color:#a6e22e>firstName</span><span style=color:#e6db74>}</span><span style=color:#e6db74>`</span>}&lt;/<span style=color:#f92672>p</span>&gt; <span style=color:#75715e>&lt;!--</span> <span style=color:#960050;background-color:#1e0010>ポイント</span><span style=color:#ae81ff>3</span> <span style=color:#f92672>--&gt;</span>
<span style="margin-right:.4em;padding:0 .4em;color:#7f7f7f">34</span>                    );
<span style="margin-right:.4em;padding:0 .4em;color:#7f7f7f">35</span>                })
<span style="margin-right:.4em;padding:0 .4em;color:#7f7f7f">36</span>            }
<span style="margin-right:.4em;padding:0 .4em;color:#7f7f7f">37</span>        &lt;/&gt;
<span style="margin-right:.4em;padding:0 .4em;color:#7f7f7f">38</span>    );
<span style="margin-right:.4em;padding:0 .4em;color:#7f7f7f">39</span>};
<span style="margin-right:.4em;padding:0 .4em;color:#7f7f7f">40</span>
<span style="margin-right:.4em;padding:0 .4em;color:#7f7f7f">41</span><span style=color:#66d9ef>export</span> <span style=color:#66d9ef>default</span> <span style=color:#a6e22e>Users</span>;
</code></pre></div><p>まず初めに登場する型は、<code>React.FC</code>（8行目）です。<br>この型は React Functional Component を意味します。</p><p>次に登場するのは、9行目の <code>useState&lt;User[] | undefined></code> ですね。<br>この定義は、<code>userList</code> の型が User[] または undefined であることを示します。</p><p>あとは、useEffect() でさきほど実装した API リクエストを行い、<br>取得したユーザ情報を <code>userList</code> にセットしています。</p><br><p>このとき、33行目のユーザ情報表示処理では、<br>User インターフェースを定義しているため、<br>IDE において、どういったキーが存在するかが補完候補として出てきます！ ↓</p><img src=https://yyh-gl.github.io/tech-blog/img/tech-blog/2019/12/react_typescript_sample/complement.png width=700><p>型がちゃんと定義されているので、<br>取得したデータに対して、どういった処理ができる（どのメソッドを適用できる）かが明確になり、<br>凡ミスを減らすことができますし、コードの可読性向上にも繋がります。</p><p>いいですね！</p><p>実践編は以上です。<br>API リクエスト部分だけかよというツッコミはどうかご勘弁を😇</p><p>最後に TypeScript を使う上での注意点と最新版で追加された機能を少し紹介して終わりにしたいと思います。</p><br><hr><h1 id=typescriptを使う上での注意点>TypeScriptを使う上での注意点</h1><hr><h2 id=typescript-の型情報はなくなる>TypeScript の型情報はなくなる</h2><p>TypeScript で型を定義していたとしても、最終的にそのコードは JavaScript に変換されます。</p><p>ご存知のとおり、JavaScript には型などありません。<br>したがって、実際に動くコードには型情報はついていません。</p><p>あくまで開発段階で型の整合性チェックや補完などができるだけであること、<br>ちゃんと理解しておくことが、とても重要だと思います。</p><br><h2 id=create-react-app-では使えない機能がある>create-react-app では使えない機能がある</h2><p>create-react-app の最新版 3.2.0 では、<br>TypeScript 3.7 から使用できる一部機能にまだ対応していません。</p><p>本内容については、次章にて詳細に話します。</p><br><hr><h1 id=最新安定版-37-で追加された機能>最新安定版 3.7 で追加された機能</h1><hr><p>2019年11月7日にメジャーアップデートが行われ、バージョン 3.7 がリリースされました。<br>今回は以下の新機能をついて紹介します。</p><br><h2 id=optional-chaininghttpswwwtypescriptlangorgdocshandbookrelease-notestypescript-3-7htmloptional-chaining><a href=https://www.typescriptlang.org/docs/handbook/release-notes/typescript-3-7.html#optional-chaining>Optional Chaining</a></h2><p>Kotlin を書いたことがある人は、見覚えのある文法ではないでしょうか？</p><div class=highlight><pre style=color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-typescript data-lang=typescript><span style="margin-right:.4em;padding:0 .4em;color:#7f7f7f">1</span><span style=color:#66d9ef>let</span> <span style=color:#a6e22e>x</span> <span style=color:#f92672>=</span> <span style=color:#a6e22e>foo</span><span style=color:#f92672>?</span>.<span style=color:#a6e22e>bar</span>.<span style=color:#a6e22e>baz</span>();
</code></pre></div><p>このように書けば、<code>foo</code> が null または undefined じゃない場合にのみ <code>foo.bar.baz()</code> を実行します。<br>下記のコードと同義です。</p><div class=highlight><pre style=color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-typescript data-lang=typescript><span style="margin-right:.4em;padding:0 .4em;color:#7f7f7f">1</span><span style=color:#66d9ef>let</span> <span style=color:#a6e22e>x</span> <span style=color:#f92672>=</span> (<span style=color:#a6e22e>foo</span> <span style=color:#f92672>===</span> <span style=color:#66d9ef>null</span> <span style=color:#f92672>||</span> <span style=color:#a6e22e>foo</span> <span style=color:#f92672>===</span> <span style=color:#66d9ef>undefined</span>) <span style=color:#f92672>?</span>
<span style="margin-right:.4em;padding:0 .4em;color:#7f7f7f">2</span>    <span style=color:#66d9ef>undefined</span> <span style=color:#f92672>:</span>
<span style="margin-right:.4em;padding:0 .4em;color:#7f7f7f">3</span>    <span style=color:#a6e22e>foo</span>.<span style=color:#a6e22e>bar</span>.<span style=color:#a6e22e>baz</span>();
</code></pre></div><br><p>ここで、さきほど、最新版の create-react-app では 最新版 TypeScript の一部機能が使えないと言いましたが、<br>その機能がこの Optional Chaining です。</p><p>本機能を使用しようとすると、</p><div class=highlight><pre style=color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-zsh data-lang=zsh><span style="margin-right:.4em;padding:0 .4em;color:#7f7f7f"> 1</span>./src/pages/users.tsx
<span style="margin-right:.4em;padding:0 .4em;color:#7f7f7f"> 2</span>SyntaxError: /Users/yyh-gl/workspaces/React/react-typescript-sample/src/pages/users.tsx: Support <span style=color:#66d9ef>for</span> the experimental syntax <span style=color:#e6db74>&#39;optionalChaining&#39;</span> isn<span style=color:#e6db74>&#39;t currently enabled (29:25):
</span><span style="margin-right:.4em;padding:0 .4em;color:#7f7f7f"> 3</span><span style=color:#e6db74>
</span><span style="margin-right:.4em;padding:0 .4em;color:#7f7f7f"> 4</span><span style=color:#e6db74>  27 |             &lt;h1&gt;User List&lt;/h1&gt;
</span><span style="margin-right:.4em;padding:0 .4em;color:#7f7f7f"> 5</span><span style=color:#e6db74>  28 |             {
</span><span style="margin-right:.4em;padding:0 .4em;color:#7f7f7f"> 6</span><span style=color:#e6db74>&gt; 29 |                 userList?.map((user) =&gt; {
</span><span style="margin-right:.4em;padding:0 .4em;color:#7f7f7f"> 7</span><span style=color:#e6db74>     |                         ^
</span><span style="margin-right:.4em;padding:0 .4em;color:#7f7f7f"> 8</span><span style=color:#e6db74>  30 |                     return (
</span><span style="margin-right:.4em;padding:0 .4em;color:#7f7f7f"> 9</span><span style=color:#e6db74>  31 |                         &lt;p&gt;{user.firstName}&lt;/p&gt;
</span><span style="margin-right:.4em;padding:0 .4em;color:#7f7f7f">10</span><span style=color:#e6db74>  32 |                     );
</span><span style="margin-right:.4em;padding:0 .4em;color:#7f7f7f">11</span><span style=color:#e6db74>
</span><span style="margin-right:.4em;padding:0 .4em;color:#7f7f7f">12</span><span style=color:#e6db74>Add @babel/plugin-proposal-optional-chaining (https://git.io/vb4Sk) to the &#39;</span>plugins<span style=color:#960050;background-color:#1e0010>&#39;</span> section of your Babel config to enable transformation.
</code></pre></div><p>このようにエラーが出て、<br>Babel（TypeScript を JavaScript に変換するやつ）の設定ファイルに<br><code>@babel/plugin-proposal-optional-chaining</code> を追加しろと言われます。</p><p>しかしながら、現在、Babel の設定ファイルである <code>.babelrc</code> や <code>babel.config.js</code> に create-react-app（厳密には <code>react-scripts</code>）が対応しておらず、読み込むことができません。</p><p>本件については、すでに Issue が出されて、PRもマージ済みということなので、<br>今後のリリースに期待ですね。。。</p><p><a href=https://qiita.com/Nkzn/items/e76b5fad43f238e76fb9#%E7%B4%A0%E3%81%AEcra%E3%81%A7%E3%81%AF%E4%BD%BF%E3%81%88%E3%81%AA%E3%81%84>参考サイト</a></p><p>なお、Optional Chaining は本家 JavaScript にも組み込まれる予定です！<br>TypeScript は、JavaScript の Class のように、<br>JavaScriptのバージョンを上げないと使えない機能を<br>ライブラリレベルで使えるようにしてくれるのでいいですね👍</p><br><h2 id=nullish-coalescinghttpswwwtypescriptlangorgdocshandbookrelease-notestypescript-3-7htmlnullish-coalescing><a href=https://www.typescriptlang.org/docs/handbook/release-notes/typescript-3-7.html#nullish-coalescing>Nullish Coalescing</a></h2><p>Nullish Coalescing をコードで表すと下記のようになります。</p><div class=highlight><pre style=color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-typescript data-lang=typescript><span style="margin-right:.4em;padding:0 .4em;color:#7f7f7f">1</span><span style=color:#66d9ef>let</span> <span style=color:#a6e22e>x</span> <span style=color:#f92672>=</span> <span style=color:#a6e22e>foo</span> <span style=color:#f92672>??</span> <span style=color:#a6e22e>bar</span>();
</code></pre></div><p><code>foo</code> が null または undefined でなければ、 <code>foo</code> が代入されます。<br>null または undefined であれば、<code>bar()</code> が実行されます。</p><p>下記のコードと同義です。</p><div class=highlight><pre style=color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-typescript data-lang=typescript><span style="margin-right:.4em;padding:0 .4em;color:#7f7f7f">1</span><span style=color:#66d9ef>let</span> <span style=color:#a6e22e>x</span> <span style=color:#f92672>=</span> (<span style=color:#a6e22e>foo</span> <span style=color:#f92672>!==</span> <span style=color:#66d9ef>null</span> <span style=color:#f92672>&amp;&amp;</span> <span style=color:#a6e22e>foo</span> <span style=color:#f92672>!==</span> <span style=color:#66d9ef>undefined</span>) <span style=color:#f92672>?</span>
<span style="margin-right:.4em;padding:0 .4em;color:#7f7f7f">2</span>    <span style=color:#a6e22e>foo</span> :
<span style="margin-right:.4em;padding:0 .4em;color:#7f7f7f">3</span>    <span style=color:#66d9ef>bar</span>();
</code></pre></div><p>コードの記述量が減っていいですね👍</p><br><hr><h1 id=まとめ>まとめ</h1><hr><p>TypeScript 入門 いかがでしたでしょうか？</p><p>詳細な説明を飛ばしたところもありましたが、<br>TypeScript がどんな感じなのか、少しでも感じてもらえたならば幸いです。</p><p>TypeScript は型に注目がいきがちですが、<br>他にも様々な便利機能があるので、どんどん使い倒していきたいですね！</p><p>明日からのアドベントカレンダー記事も楽しみです😃</p><br><p>TypeScript Advent Calendar 2019、<br>明日は <a href=https://qiita.com/kimromi>kimromi</a> さんの『<a href=https://kimromi.hatenablog.jp/entry/2019/12/03/134214>FlowからTypeScriptに段階的に移行する</a>』です🛫</p></div><footer><div class=stats><ul class=categories><li><a class=article-terms-link href=/tech-blog/categories/react/>React</a></li><li><a class=article-terms-link href=/tech-blog/categories/typescript/>TypeScript</a></li><li><a class=article-terms-link href=/tech-blog/categories/advent-calendar/>Advent Calendar</a></li></ul><div><good-counter url=/tech-blog/blog/react_typescript_sample/></good-counter></div></div></footer></article><div class=pagination><a href=/tech-blog/blog/golang-vcr/ class="button left"><span>【Golang+VCR】外部APIとの通信を保存してテストに使用する話</span></a>
<a href=/tech-blog/blog/denago_3/ class="button right"><span>【DeNA.go #3】Go活用事例やパフォーマンスチューニングの話聞いてきた</span></a></div></main><section id=site-sidebar><section id=recent-posts><header><h1>最近の投稿</h1></header><article class=mini-post><a href=/tech-blog/blog/go-switch-fallthrough/ class=image style="--bg-image: url('https://yyh-gl.github.io/tech-blog/img/tech-blog/2020/10/go-switch-fallthrough/featured.png')"><img src=https://yyh-gl.github.io/tech-blog/img/tech-blog/2020/10/go-switch-fallthrough/featured.png alt=featured></a><header><h2><a href=/tech-blog/blog/go-switch-fallthrough/>【Go】Switch文のfallthroughに関するまとめ</a></h2><time class=published datetime="2020-10-03 00:00:00 +0000 UTC">2020-10-03</time></header></article><article class=mini-post><a href=/tech-blog/blog/podcast-matome-texta-200827/ class=image style="--bg-image: url('https://yyh-gl.github.io/tech-blog/img/tech-blog/2020/10/podcast-matome-texta-200827/featured.png')"><img src=https://yyh-gl.github.io/tech-blog/img/tech-blog/2020/10/podcast-matome-texta-200827/featured.png alt=featured></a><header><h2><a href=/tech-blog/blog/podcast-matome-texta-200827/>texta.fm #1 まとめ</a></h2><time class=published datetime="2020-10-01 00:00:00 +0000 UTC">2020-10-01</time></header></article><article class=mini-post><a href=/tech-blog/blog/go-always-passing-by-value/ class=image style="--bg-image: url('https://yyh-gl.github.io/tech-blog/img/tech-blog/2020/06/go-always-passing-by-value/featured.png')"><img src=https://yyh-gl.github.io/tech-blog/img/tech-blog/2020/06/go-always-passing-by-value/featured.png alt=featured></a><header><h2><a href=/tech-blog/blog/go-always-passing-by-value/>Goの参照渡しについて調べてみた</a></h2><time class=published datetime="2020-06-14 00:00:00 +0000 UTC">2020-06-14</time></header></article><footer><a href=/tech-blog/blog/ class=button>続きを見る</a></footer></section><section id=categories><header><h1><a href=/tech-blog/categories>Categories</a></h1></header><ul><li><a href=/tech-blog/categories/go/>go<span class=count>17</span></a><li><a href=/tech-blog/categories/%E5%8B%89%E5%BC%B7%E4%BC%9A/>勉強会<span class=count>6</span></a><li><a href=/tech-blog/categories/ddd/>ddd<span class=count>5</span></a><li><a href=/tech-blog/categories/advent-calendar/>advent-calendar<span class=count>3</span></a><li><a href=/tech-blog/categories/web-api/>web-api<span class=count>3</span></a><li><a href=/tech-blog/categories/%E3%82%A2%E3%83%BC%E3%82%AD%E3%83%86%E3%82%AF%E3%83%81%E3%83%A3/>アーキテクチャ<span class=count>3</span></a><li><a href=/tech-blog/categories/%E8%AA%AD%E6%9B%B8%E3%81%BE%E3%81%A8%E3%82%81/>読書まとめ<span class=count>3</span></a><li><a href=/tech-blog/categories/html/css/>html/css<span class=count>2</span></a><li><a href=/tech-blog/categories/react/>react<span class=count>2</span></a><li><a href=/tech-blog/categories/web%E5%85%A8%E8%88%AC/>web全般<span class=count>2</span></a><li><a href=/tech-blog/categories/%E3%82%BB%E3%82%AD%E3%83%A5%E3%83%AA%E3%83%86%E3%82%A3/>セキュリティ<span class=count>2</span></a><li><a href=/tech-blog/categories/%E3%83%86%E3%82%B9%E3%83%88/>テスト<span class=count>2</span></a><li><a href=/tech-blog/categories/android/>android<span class=count>1</span></a><li><a href=/tech-blog/categories/aws/>aws<span class=count>1</span></a><li><a href=/tech-blog/categories/ci/cd/>ci/cd<span class=count>1</span></a><li><a href=/tech-blog/categories/ecs/>ecs<span class=count>1</span></a><li><a href=/tech-blog/categories/firebase/>firebase<span class=count>1</span></a><li><a href=/tech-blog/categories/github/>github<span class=count>1</span></a><li><a href=/tech-blog/categories/kotlin/>kotlin<span class=count>1</span></a><li><a href=/tech-blog/categories/lint/>lint<span class=count>1</span></a><li><a href=/tech-blog/categories/podcast/>podcast<span class=count>1</span></a><li><a href=/tech-blog/categories/rds/>rds<span class=count>1</span></a><li><a href=/tech-blog/categories/terraform/>terraform<span class=count>1</span></a><li><a href=/tech-blog/categories/typescript/>typescript<span class=count>1</span></a><li><a href=/tech-blog/categories/vue.js/>vue.js<span class=count>1</span></a><li><a href=/tech-blog/categories/%E3%82%B9%E3%82%AF%E3%83%A9%E3%83%A0/>スクラム<span class=count>1</span></a><li><a href=/tech-blog/categories/%E3%83%81%E3%83%BC%E3%83%A0%E3%83%9E%E3%83%8D%E3%82%B8%E3%83%A1%E3%83%B3%E3%83%88/>チームマネジメント<span class=count>1</span></a><li><a href=/tech-blog/categories/%E3%83%9D%E3%82%A8%E3%83%A0/>ポエム<span class=count>1</span></a><li><a href=/tech-blog/categories/%E5%85%A5%E9%96%80/>入門<span class=count>1</span></a><li><a href=/tech-blog/categories/%E7%B0%A1%E5%8D%98%E3%81%BE%E3%81%A8%E3%82%81/>簡単まとめ<span class=count>1</span></a><li><a href=/tech-blog/categories/%E8%87%AA%E5%B7%B1%E7%B4%B9%E4%BB%8B/>自己紹介<span class=count>1</span></a></li></ul></section><section id=mini-bio><header><h1>About</h1></header><p>東京で働くソフトウェアエンジニアです。バックエンドがメインですが、フロントやインフラもさわっています。</p><footer><a href=/tech-blog/about class=button>もっと詳しく知る</a></footer></section></section><footer id=site-footer><ul class=socnet-icons><li><a href=//github.com/yyh-gl target=_blank rel=noopener title=GitHub class="fab fa-github"></a></li><li><a href=//twitter.com/yyh_gl target=_blank rel=noopener title=Twitter class="fab fa-twitter"></a></li></ul><p class=copyright>© 2020 yyh-gl's Tech Blog<br>Theme: <a href=https://github.com/pacollins/hugo-future-imperfect-slim target=_blank rel=noopener>Hugo Future Imperfect Slim</a><br>A <a href=https://html5up.net/future-imperfect target=_blank rel=noopener>HTML5 UP port</a> | Powered by <a href=https://gohugo.io/ title=0.77.0 target=_blank rel=noopener>Hugo</a></p></footer><a id=back-to-top href=# class="fas fa-arrow-up fa-2x"></a><script src=/tech-blog/js/bundle.min.11dc02371cad2fde919e03b0002d46d9cd2420aeab5f006e3f3ae9662ba228f8.js integrity="sha256-EdwCNxytL96RngOwAC1G2c0kIK6rXwBuPzrpZiuiKPg="></script><script src=/tech-blog/js/add-on.js></script><script type=application/javascript>var doNotTrack=false;if(!doNotTrack){window.ga=window.ga||function(){(ga.q=ga.q||[]).push(arguments)};ga.l=+new Date;ga('create','UA-140914324-1','auto');ga('send','pageview');}</script><script async src=https://www.google-analytics.com/analytics.js></script></div></body></html>